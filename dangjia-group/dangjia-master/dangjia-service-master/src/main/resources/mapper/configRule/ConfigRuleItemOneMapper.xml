<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dangjia.acg.mapper.configRule.IConfigRuleItemOneMapper">

    <select id="getRuleItemOneData" resultType="com.dangjia.acg.model.config.DjConfigRuleItemOne">
       SELECT
            o.id,
            IFNULL(o.module_id, #{moduleId}) moduleId,
           IFNULL(o.batch_code, #{batchCode}) batchCode,
            o.type_id,
            r.id rankId,
            IFNULL(o.rule_field_name, #{fieldName}) ruleFieldName,
            IFNULL(o.rule_field_value, '0') ruleFieldValue,
            IFNULL(o.rule_field_code, #{fieldKey}) ruleFieldCode,
            o.create_date createDate,
            o.modify_date modifyDate,
            o.data_status dataStatus
        FROM
            dj_config_rule_rank r
        LEFT JOIN dj_config_rule_item_one o ON r.id = o.rank_id
        AND o.module_id=#{moduleId}
        <if test="null!=typeId and ''!=typeId">
            AND o.type_id=#{typeId}
        </if>
        ORDER BY o.create_date DESC LIMIT #{limit}
    </select>
</mapper>

