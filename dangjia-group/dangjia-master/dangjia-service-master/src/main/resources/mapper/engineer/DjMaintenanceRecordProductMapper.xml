<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dangjia.acg.mapper.engineer.DjMaintenanceRecordProductMapper">

    <select id="queryDjMaintenanceRecordProductList"
            resultType="com.dangjia.acg.dto.engineer.DjMaintenanceRecordProductDTO">
        SELECT
            mrp.id,
            mrp.product_id productId,
            bsp.product_name productName,
            mrp.shop_count shopCount,
            (
                mrp.shop_count * bsp.sell_price
            ) totalPrice,
            bsp.image,
            bpt.value_id_arr as valueIdArr
        FROM
            dj_maintenance_record_product mrp,
            dj_basics_storefront_product bsp,
            dj_basics_product_template bpt
        WHERE
            mrp.product_id = bsp.id and bsp.prod_template_id = bpt.id
            AND mrp.maintenance_record_id=#{maintenanceRecordId}
    </select>
</mapper>